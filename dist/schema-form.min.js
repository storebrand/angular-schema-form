var deps=["ObjectPath"];try{angular.module("ngSanitize"),deps.push("ngSanitize")}catch(e){}try{angular.module("ui.sortable"),deps.push("ui.sortable")}catch(e){}try{angular.module("angularSpectrumColorpicker"),deps.push("angularSpectrumColorpicker")}catch(e){}try{angular.module("ui.utils.masks"),deps.push("ui.utils.masks")}catch(e){}try{angular.module("ui.bootstrap"),deps.push("ui.bootstrap")}catch(e){}angular.module("schemaForm",deps).run(["$locale",function(e){e.NUMBER_FORMATS.GROUP_SEP=" "}]),angular.module("schemaForm").provider("sfPath",["ObjectPathProvider",function(e){var r={parse:e.parse};1===angular.version.major&&angular.version.minor<3?r.stringify=function(e){return Array.isArray(e)?e.join("."):e.toString()}:r.stringify=e.stringify,r.normalize=function(e,t){return r.stringify(Array.isArray(e)?e:r.parse(e),t)},this.parse=r.parse,this.stringify=r.stringify,this.normalize=r.normalize,this.$get=function(){return r}}]),angular.module("schemaForm").filter("reduceMessage",[function(){return function(e){return angular.isArray(e)?e.join("<br>"):e}}]),angular.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function(e,r){var t="",n={},a=function(e,r){"sfDecorator"===e&&(e=t);for(var a=n[e],i=a.rules,o=0;o<i.length;o++){var l=i[o](r);if(l)return l}return a.mappings[r.type]?a.mappings[r.type]:a.mappings["default"]},i=function(e){return/^#/.test(e)?"['"+e+"']":"."+e},o=function(e,r,t){var n="";if(angular.isDefined(e.schema)){var a=e.schema.visibility||r.visibility,o=r.prefix||"";a&&(n+=i(o+a));var l=e.schema.category||r.category;l&&(n+=i(o+l))}return n+=("["!==t[0]?".":"")+t,"model"+n},l=function(t){e.directive(t,["$parse","$compile","$http","$templateCache","scrollingTop","$timeout","$filter",function(e,n,l,s,u,c,f){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(u,c,d,m){var p=u.defaultGlobals||u.$eval(d.defaultGlobals),h=u.$watch(d.form,function(e){if(e){u.form=e,u.defaultGlobals=p;var i=a(t,e);l.get(i,{cache:s}).then(function(t){var a=e.key?r.stringify(e.key).replace(/"/g,"&quot;"):"";u.keyModelName=o(e,u.defaultGlobals,a);var i=t.data.replace(/\$\$value\$\$/g,u.keyModelName);c.html(i),n(c.contents())(u)}),h()}});u.globalSchema=m.evalInMainScope("schema"),u.showTitle=function(){return u.form&&u.form.notitle!==!0&&u.form.title},u.listToCheckboxValues=function(e){var r={};return angular.forEach(e,function(e){r[e]=!0}),r},u.checkboxValuesToList=function(e){var r=[];return angular.forEach(e,function(e,t){e&&r.push(t)}),r},u.buttonClick=function(e,r){angular.isFunction(r.onClick)?r.onClick(e,r):angular.isString(r.onClick)&&(m?m.evalInParentScope(r.onClick,{$event:e,form:r}):u.$eval(r.onClick,{$event:e,form:r}))},u.updateModelForInputFile=function(e){u.$apply(function(){var r={};r.fileName=e.split("\\").pop(),r.fileExt=r.fileName.split(".").pop(),u.form.fileList||(u.form.fileList=[]),u.form.fileList.push(r)})},u.removeFileFromList=function(e){u.form.fileList.splice(e,1)};var v=function(e){var r="";angular.isArray(e)&&(e=e.join("."));var t=u.globalSchema.properties[e];if(angular.isDefined(t)){var n=t.visibility||u.defaultGlobals.visibility,a=u.defaultGlobals.prefix||"";n&&(r+=i(a+n));var o=t.category||u.defaultGlobals.category;o&&(r+=i(a+o))}return r+=("["!==e[0]?".":"")+e,"model"+r},g=function(e){return e?(angular.forEach(u.form.dependencies,function(r){e=e.replace(r,v(r))}),u.$eval(e)):!1},y=function(){var e;return angular.forEach(u.form.conditionalValues,function(r){g(r.expression)&&(e=r.value)}),e};u.showCondition=function(){var r=u.isFormVisible(),t=u.isFormDisabled();$(u.form,r,t);var n=e(u.keyModelName);if(angular.isArray(u.form.conditionalValues)){var a=y();angular.isDefined(a)&&n.assign(u,a)}else u.form.key&&!r&&(n.assign(u,void 0),u.ngModelHolder&&(u.ngModelHolder.$render(),u.ngModelHolder.$setPristine()));return r},u.clickCheckbox=function(){var e=c.find("input"),r=!!e.attr("checked");e.attr("checked",!r),u.ngModelHolder.$setViewValue(!r),u.ngModelHolder.$render()},u.changeCheckbox=function(){var e=c.find("input");e.attr("checked",u.ngModelHolder.$modelValue)},u.isFormDisabled=function(){var e=u.form.disableExpression;return angular.isUndefined(e)&&angular.isUndefined(u.form.disabled)?!1:g(e)},u.isFormVisible=function(){var e=u.form.expression;return angular.isUndefined(e)?!0:g(e)};var $=function(e,r,t){angular.isDefined(e.required)&&(e.required=r&&!t,e.schema.required=r&&!t)};u.disabledElement=function(){var e=u.isFormDisabled(),r=u.isFormVisible();return $(u.form,r,e),e&&(u.ngModelHolder.$setPristine(),""===c.find("input").val()&&(u.ngModelHolder.$setViewValue(void 0),u.ngModelHolder.$setPristine())),e||u.form.disabled};var b=function(e){var r=moment(),t=u.form.minMonthlyDifference||0,n=u.form.maxMonthlyDifference,a=u.form.additionalMonthlyDifference,i=u.form.additionalDailyDifference,o=moment(e);return r.milliseconds(0),r.second(0),r.minute(0),r.hours(0),(!e||n&&a&&(o.toDate().getTime()<moment(r).add(t,"Month").toDate().getTime()||o.toDate().getTime()>moment(r).add(n,"Month").toDate().getTime()))&&(o=r.add(a,"Month").add(i,"Day")),o};u.getInfoDate=function(){if(g(u.form.expression)){var r=u.form.dateKey&&u.$eval(v(u.form.dateKey)),t=b(r),n=e(v(u.form.modelKey));return n.assign(u,t.format("YYYY-MM-DD")),moment.locale(u.form.encoding),moment(t).format(u.form.format)}},u.conditionalValidationSuccess=function(){var e=u.form.validationExpression;return angular.isUndefined(e)?!0:g(e)},u.extendUserForm=function(r){var t=function(e,r,t){i.validationExpression=""+e,l.validationExpression=""+e,c.expression=""+!r,d&&(d.expression=""+(r&&void 0!==t&&!t))},n=f("filter")(r.items,{itemType:"personNumber"})[0],a=v(n.key),i=f("filter")(r.items,{itemType:"firstName"})[0],o=v(i.key),l=f("filter")(r.items,{itemType:"lastName"})[0],s=v(l.key),c=f("filter")(r.items,{itemType:"userError"})[0],d=f("filter")(r.items,{itemType:"countryCodeError"})[0],m={},p=function(){var e=u.$eval(a),r=u.$eval(o),t=u.$eval(s);e&&r&&t&&u.$emit("customer:validate",{ssn:e,firstName:r,lastName:t})};t(!1,!0,!0),u.$watch(function(){return u.$eval(a)},function(e){e&&p()}),u.$watch(function(){return u.$eval(o)},function(e){e&&m.firstName!==e&&p()}),u.$watch(function(){return u.$eval(s)},function(e){e&&m.lastName!==e&&p()}),u.$on("customer:isValid",function(r,n){n.isValid&&(m=n,e(o).assign(u,n.firstName),e(s).assign(u,n.lastName)),t(n.isValid,n.isValid,n.isValidCountryCode)})},u.evalExpr=function(e,r){return m?m.evalInParentScope(e,r):u.$eval(e,r)},u.evalInScope=function(e,r){return e?u.$eval(e,r):void 0},u.errorMessage=function(e){return u.form.validationMessage?e?angular.isString(u.form.validationMessage)?u.form.validationMessage:u.form.validationMessage[e.code]||u.form.validationMessage["default"]:u.form.validationMessage.required||u.form.validationMessage["default"]||u.form.validationMessage:e?e.message:"Required"}}}}])},s=function(r,t,n){n=angular.isDefined(n)?n:!1,e.directive("sf"+angular.uppercase(r[0])+r.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:n,template:'<sf-decorator form="form"></sf-decorator>',link:function(e,t,n){var a={items:"c",titleMap:"c",schema:"c"},i={type:r},o=!0;angular.forEach(n,function(r,t){if("$"!==t[0]&&0!==t.indexOf("ng")&&"sfField"!==t){var l=function(r){angular.isDefined(r)&&r!==i[t]&&(i[t]=r,o&&i.type&&(i.key||angular.isUndefined(n.key))&&(e.form=i,o=!1))};"model"===t?e.$watch(r,function(r){r&&e.model!==r&&(e.model=r)}):"c"===a[t]?e.$watchCollection(r,l):n.$observe(t,l)}})}}})};this.createDecorator=function(e,r,a){n[e]={mappings:r||{},rules:a||[]},n[t]||(t=e),l(e)},this.createDirective=s,this.createDirectives=function(e){angular.forEach(e,function(e,r){s(r,e)})},this.directive=function(e){return e=e||t,n[e]},this.addMapping=function(e,r,t){n[e]&&(n[e].mappings[r]=t)},this.$get=function(){return{directive:function(e){return n[e]},defaultDecorator:t}},l("sfDecorator")}]),angular.module("schemaForm").factory("formFormatters",[function(){var e={carNumber:function(e){return/^[a-zA-Z]{2}\s?\d{5}$/.test(e)&&(e=e.replace(/^([a-zA-Z]{2})\s?(\d{5})$/,function(e,r,t){return r.toUpperCase()+t})),e},number:function(e){var r=parseInt(e,10);return isNaN(r)?void 0:r},phoneNumber:function(e){return e=e.replace(/\s+/g,""),e=e.replace(/\-+/g,""),/^\d{8}$/.test(e)?e:void 0}};return{getFormatter:function(r){return e[r]}}}]),angular.module("schemaForm").provider("schemaForm",["sfPathProvider",function(e){var r=function(e){var r=[];return e.forEach(function(e){r.push({name:e,value:e,id:"id_"+100*Math.random()})}),r},t=function(e){if(angular.isArray(e))return angular.forEach(e,function(e,r){e.id||(e.id="id_"+100*Math.random())}),e;var r=[];return angular.forEach(e,function(e,t){r.push({name:e,value:t,id:"id_"+100*Math.random()})}),r},n=function(e,r,t){var n=m[r.type];if(n)for(var a,i=0;i<n.length;i++)if(a=n[i](e,r,t))return a},a=function(e,r,n){n=n||{};var a=n.global&&n.global.formDefaults?angular.copy(n.global.formDefaults):{};return n.global&&n.global.supressPropertyTitles===!0?a.title=r.title:a.title=r.title||e,r.description&&(a.description=r.description),(n.required===!0||r.required===!0)&&(a.required=!0),r.maxLength&&(a.maxlength=r.maxLength),r.minLength&&(a.minlength=r.minLength),(r.readOnly||r.readonly)&&(a.readonly=!0),r.minimum&&(a.minimum=r.minimum+(r.exclusiveMinimum?1:0)),r.maximum&&(a.maximum=r.maximum-(r.exclusiveMaximum?1:0)),r.validationMessage&&(a.validationMessage=r.validationMessage),r.enumNames&&(a.titleMap=t(r.enumNames)),a.schema=r,a.ngModelOptions=a.ngModelOptions||{},a},i=function(r,t,n){if("string"===t.type&&!t["enum"]){var i=a(r,t,n);return i.key=n.path,i.type="text",n.lookup[e.stringify(n.path)]=i,i}},o=function(r,t,n){if("number"===t.type){var i=a(r,t,n);return i.key=n.path,i.type="number",n.lookup[e.stringify(n.path)]=i,i}},l=function(r,t,n){if("integer"===t.type){var i=a(r,t,n);return i.key=n.path,i.type="number",n.lookup[e.stringify(n.path)]=i,i}},s=function(r,t,n){if("boolean"===t.type){var i=a(r,t,n);return i.key=n.path,i.type="checkbox",n.lookup[e.stringify(n.path)]=i,i}},u=function(t,n,i){if("string"===n.type&&n["enum"]){var o=a(t,n,i);return o.key=i.path,o.type="select",o.titleMap||(o.titleMap=r(n["enum"])),i.lookup[e.stringify(i.path)]=o,o}},c=function(t,n,i){if("array"===n.type&&n.items&&n.items["enum"]){var o=a(t,n,i);return o.key=i.path,o.type="checkboxes",o.titleMap||(o.titleMap=r(n.items["enum"])),i.lookup[e.stringify(i.path)]=o,o}},f=function(r,t,i){if("object"===t.type){var o=a(r,t,i);return o.type="fieldset",o.items=[],i.lookup[e.stringify(i.path)]=o,angular.forEach(t.properties,function(r,a){var l=i.path.slice();if(l.push(a),i.ignore[e.stringify(l)]!==!0){var s=t.required&&-1!==t.required.indexOf(a),u=n(a,r,{path:l,required:s||!1,lookup:i.lookup,ignore:i.ignore});u&&o.items.push(u)}}),o}},d=function(r,t,i){if("array"===t.type){var o=a(r,t,i);o.type="array",o.key=i.path,i.lookup[e.stringify(i.path)]=o;var l=t.required,s=i.path.slice();return s.push(""),o.items=[n(r,t.items,{path:s,required:l||!1,lookup:i.lookup,ignore:i.ignore})],o}},m={string:[u,i],object:[f],number:[o],integer:[l],"boolean":[s],array:[c,d]},p=function(e){return e};this.defaults=m,this.stdFormObj=a,this.postProcess=function(e){p=e},this.appendRule=function(e,r){m[e]||(m[e]=[]),m[e].push(r)},this.prependRule=function(e,r){m[e]||(m[e]=[]),m[e].unshift(r)},this.createStandardForm=a,this.$get=function(){var r={};return r.merge=function(n,a,i,o){a=a||["*"],o=o||{};var l=r.defaults(n,i,o),s=a.indexOf("*");if(-1!==s)return a=a.slice(0,s).concat(l.form).concat(a.slice(s+1));var u=l.lookup;return p(a.map(function(a){if("string"==typeof a&&(a={key:a}),a.titleMap&&(a.titleMap=t(a.titleMap)),a.items&&(a.items=r.merge(n,a.items,i)),a.tabs&&angular.forEach(a.tabs,function(e){e.items=r.merge(n,e.items,i)}),a.steps&&angular.forEach(a.steps,function(e){e.items=r.merge(n,e.items,i)}),a.key){"string"==typeof a.key&&(a.key=e.parse(a.key));var o=e.stringify(a.key);u[o]&&(a=angular.extend(u[o],a))}return a}))},r.defaults=function(e,r,t){var a=[],i={};if(r=r||{},t=t||{},"object"!==e.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return angular.forEach(e.properties,function(o,l){if(r[l]!==!0){var s=e.required&&-1!==e.required.indexOf(l[l.length-1]),u=n(l,o,{path:[l],lookup:i,ignore:r,required:s,global:t});u&&a.push(u)}}),{form:a,lookup:i}},r.traverseSchema=function(e,r,t,n){n=angular.isDefined(n)?n:!0,t=t||[];var a=function(e,r,t){if(r(e,t),angular.forEach(e.properties,function(e,n){var i=t.slice();i.push(n),a(e,r,i)}),!n&&e.items){var i=t.slice();i.push(""),a(e.items,r,i)}};a(e,r,t||[])},r.traverseForm=function(e,t){t(e),angular.forEach(e.items,function(e){r.traverseForm(e,t)}),e.tabs&&angular.forEach(e.tabs,function(e){angular.forEach(e.items,function(e){r.traverseForm(e,t)})}),e.steps&&angular.forEach(e.steps,function(e){angular.forEach(e.items,function(e){r.traverseForm(e,t)})})},r}}]),angular.module("schemaForm").factory("scrollingTop",["$timeout",function(e){var r=function(r,t){e(function(){jQuery("html, body").animate({scrollTop:jQuery(r[0]).find("[index="+t+"] .has-error:first").offset().top},1e3)},0)},t=function(){e(function(){jQuery("html, body").animate({scrollTop:0},1e3)},0)};return{scrollToTheFirstError:r,scrollTop:t}}]),angular.module("schemaForm").factory("sfSelect",["sfPath",function(e){var r=/^\d+$/;return function(t,n,a){n||(n=this);var i="string"==typeof t?e.parse(t):t;if("undefined"!=typeof a&&1===i.length)return n[i[0]]=a,n;"undefined"!=typeof a&&"undefined"==typeof n[i[0]]&&(n[i[0]]=i.length>2&&r.test(i[1])?[]:{});for(var o=n[i[0]],l=1;l<i.length;l++){if(""===i[l])return void 0;if("undefined"!=typeof a){if(l===i.length-1)return o[i[l]]=a,a;var s=o[i[l]];("undefined"==typeof s||null===s)&&(s=r.test(i[l+1])?[]:{},o[i[l]]=s),o=s}else o&&(o=o[i[l]])}return o}}]),angular.module("schemaForm").factory("sfValidator",[function(){var e={};return tv4.addFormat({ssn:function(e,r){var t,n=[3,7,6,1,8,9,4,5,2,1,0],a=[5,4,3,2,7,6,5,4,3,2,1],i=0,o=0,l=0;if("string"!=typeof e)return"ssn should be a string!";for(t=e.split("");l<n.length;l+=1)i+=t[l]*n[l],o+=t[l]*a[l];return i%11==0&&o%11==0?null:"incorrect ssn"},email:function(e,r){return"string"==typeof e?/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/i.test(e)?null:"invalid email":"email should be a string!"}}),e.validate=function(e,r){var t=e.schema;if(!t)return r;"integer"===t.type?r=parseInt(r,10):"number"===t.type?r=parseFloat(r,10):"boolean"===t.type&&"string"==typeof r&&("true"===r?r=!0:"false"===r&&(r=!1));var n={type:"object",properties:{}},a=e.key[e.key.length-1];n.properties[a]=t,t.required&&(n.required=[a]);var i={};return angular.isDefined(r)&&(i[a]=r),tv4.validateResult(i,n)},e}]),angular.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator",function(e,r,t){var n=function(e){return function(r){r.key&&(r.key[r.key.indexOf("")]=e)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(a,i,o,l){var s={},u=a.$watch(o.sfArray,function(i){var o=e(i.key,a.model);if(angular.isUndefined(o)&&(o=[],e(i.key,a.model,o)),a.modelArray=o,i.items){var c=i.items[0];i.items.length>1&&(c={type:"section",items:i.items})}if(a.copyWithIndex=function(e){if(!s[e]&&c){var t=angular.copy(c);t.arrayIndex=e,r.traverseForm(t,n(e)),s[e]=t}return s[e]},a.appendToArray=function(){var t=o.length,n=a.copyWithIndex(t);if(r.traverseForm(n,function(r){r.key&&angular.isDefined(r["default"])&&e(r.key,a.model,r["default"])}),t===o.length){var l,s=e("schema.items.type",i);"object"===s?l={}:"array"===s&&(l=[]),o.push(l)}return a.validateArray&&a.validateArray(),o},a.deleteFromArray=function(e){o.splice(e,1),a.validateArray&&a.validateArray()},i.titleMap||i.startEmpty===!0||0!==o.length||a.appendToArray(),i.titleMap&&i.titleMap.length>0){a.titleMapValues=[];var f=function(e){a.titleMapValues=[],e=e||[],i.titleMap.forEach(function(r){a.titleMapValues.push(-1!==e.indexOf(r.value))})};f(a.modelArray),a.$watchCollection("modelArray",f),a.$watchCollection("titleMapValues",function(e){if(e){for(var r=a.modelArray;r.length>0;)r.shift();i.titleMap.forEach(function(t,n){e[n]&&r.push(t.value)})}})}if(l){var d;a.validateArray=function(){var e=t.validate(i,a.modelArray.length>0?a.modelArray:void 0);e.valid!==!1||!e.error||""!==e.error.dataPath&&e.error.dataPath!=="/"+i.key[i.key.length-1]?l.$setValidity("schema",!0):(l.$setViewValue(a.modelArray),d=e.error,l.$setValidity("schema",!1))},a.$on("schemaFormValidate",a.validateArray),a.hasSuccess=function(){return l.$valid&&!l.$pristine},a.hasError=function(){return l.$invalid},a.schemaError=function(){return d}}u()})}}}]),angular.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(e,r,t,n){var a=e.$eval(t.sfChanged);a&&a.onChange&&n.$viewChangeListeners.push(function(){angular.isFunction(a.onChange)?a.onChange(n.$modelValue,a):e.evalExpr(a.onChange,{modelValue:n.$modelValue,form:a})})}}}),angular.module("schemaForm").directive("infoHelpMessage",[function(){return{restrict:"AE",templateUrl:"directives/decorators/stb-webmanual/info-message.html",scope:{infoMessage:"="},link:function(e,r,t){}}}]),angular.module("schemaForm").directive("ngModelOnblur",["formFormatters","$parse",function(e,r){return{restrict:"A",require:"ngModel",priority:1,link:function(r,t,n,a){if("radio"!==n.type&&"checkbox"!==n.type){var i=e.getFormatter(r.$eval(n.formatterName))||function(e){return e};t.unbind("input").unbind("keydown").unbind("change"),t.bind("blur",function(){r.$apply(function(){!/[^\s]/.test(t.val())&&a.$pristine||(a.$setViewValue(i(t.val())),a.$render())})});var o=r.$eval(n.modelMaxLength);angular.isDefined(o)&&t.bind("keydown",function(e){var r=e.which,n=32>r||r>34&&41>r||46===r;return n?!0:void(t.val().length>=o&&e.preventDefault())})}}}}]),angular.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect",function(e,r,t,n){var a=/[A-Z]/g,i=function(e,r){return r=r||"_",e.replace(a,function(e,t){return(t?r:"")+e.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel"},controller:["$scope",function(e){this.evalInParentScope=function(r,t){return e.$parent.$eval(r,t)},this.evalInMainScope=function(r,t){return e.$eval(r,t)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(a,o,l,s,u){a.formCtrl=s,a.defaultGlobals=a.$eval(l.defaultGlobals)||{visibility:"",category:"",prefix:""};var c={};u(a,function(e){if(e.addClass("schema-form-ignore"),o.prepend(e),o[0].querySelectorAll){var r=o[0].querySelectorAll("[ng-model]");if(r)for(var t=0;t<r.length;t++){var n=r[t].getAttribute("ng-model");c[n.substring(n.indexOf(".")+1)]=!0}}});var f={};a.$watch(function(){var s=a.schema,u=a.initialForm||["*"];if(u&&s&&s.type&&(f.form!==u||f.schema!==s)&&Object.keys(s.properties).length>0){f.schema=s,f.form=u;var d=a.$eval(l.sfOptions),m=r.merge(s,u,c,d),p=document.createDocumentFragment();a.schemaForm={form:m,schema:s},angular.forEach(m,function(e,r){var n=document.createElement(l.sfDecoratorName||i(t.defaultDecorator,"-"));n.setAttribute("form","schemaForm.form["+r+"]"),n.setAttribute("default-globals","defaultGlobals"),p.appendChild(n)}),o.children(":not(.schema-form-ignore)").remove(),o[0].appendChild(p),e(o.children())(a),r.traverseSchema(s,function(e,r){if(angular.isDefined(e["default"])){var t=n(r,a.model);angular.isUndefined(t)&&n(r,a.model,e["default"])}})}})}}}]),angular.module("schemaForm").directive("schemaValidate",["sfValidator",function(e){"use strict";return{restrict:"A",scope:!1,priority:1e3,require:"ngModel",link:function(r,t,n,a){var i=null;"radio"===n.type?(r=r.$parent,r.ngModel||(r.ngModel=a)):r.ngModel=a;var o=function(){return l||(l=r.$eval(n.schemaValidate)),l},l=o();l.copyValueTo&&a.$viewChangeListeners.push(function(){var e=l.copyValueTo;angular.forEach(e,function(e){sfSelect(e,r.model,a.$modelValue)})}),a.$validators?a.$validators.schema=function(t){var n=o(),a=e.validate(n,t),l=a.valid;return i=a.error,l&&n.validations&&n.validations.length&&n.validations.every(function(e){return l=e.validator(t,r.model),l?!0:(i={code:e.errorCode},!1)}),l}:a.$parsers.push(function(r){if(l=o(),!l)return r;var t=e.validate(l,r);return t.valid?(a.$setValidity("schema",!0),r):(a.$setValidity("schema",!1),void(i=t.error))});var s=function(e,r){var t=!0;return r&&r.indexOf(e)<0&&(t=!1),t};r.$on("schemaFormValidate",function(e,r){var t=r&&r.modelKeys,n=r&&r.modelKeysValidationResult;if(t&&!t.indexOf)throw'"modelKeys" property of arguments passed should be an array';if(s(l.key[0],t)){if(t&&!n)throw'"modelKeysValidationResult" property of arguments passed should be defined';a.$validate?(a.$validate(),n[l.key[0]]={isValid:a.$valid,message:a.error.message},a.$invalid&&(a.$dirty=!0,a.$pristine=!1)):a.$setViewValue(a.$viewValue)}}),r.$on("schemaFormValidationClean",function(e,r){var n=r&&r.modelKeys;if(n&&!n.indexOf)throw'"modelKeys" property of arguments passed should be an array';s(l.key[0],n)&&(t[0].value="",a.$setViewValue(void 0),a.$setPristine(),a.$render())}),r.hasSuccess=function(){return a.$valid&&(!a.$pristine||!a.$isEmpty(a.$modelValue))},r.hasError=function(){return a.$invalid&&!a.$pristine},r.schemaError=function(){return i}}}}]);