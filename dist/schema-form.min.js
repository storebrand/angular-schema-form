var deps=["ObjectPath"];try{angular.module("ngSanitize"),deps.push("ngSanitize")}catch(e){}try{angular.module("ui.sortable"),deps.push("ui.sortable")}catch(e){}try{angular.module("angularSpectrumColorpicker"),deps.push("angularSpectrumColorpicker")}catch(e){}try{angular.module("ui.bootstrap"),deps.push("ui.bootstrap")}catch(e){}try{angular.module("angularFileUpload"),deps.push("angularFileUpload")}catch(e){}angular.module("schemaForm",deps),angular.module("schemaForm").provider("sfPath",["ObjectPathProvider",function(e){var r={parse:e.parse};1===angular.version.major&&angular.version.minor<3?r.stringify=function(e){return Array.isArray(e)?e.join("."):e.toString()}:r.stringify=e.stringify,r.normalize=function(e,t){return r.stringify(Array.isArray(e)?e:r.parse(e),t)},this.parse=r.parse,this.stringify=r.stringify,this.normalize=r.normalize,this.$get=function(){return r}}]),angular.module("schemaForm").factory("sfSelect",["sfPath",function(e){var r=/^\d+$/;return function(t,a,n){a||(a=this);var i="string"==typeof t?e.parse(t):t;if("undefined"!=typeof n&&1===i.length)return a[i[0]]=n,a;"undefined"!=typeof n&&"undefined"==typeof a[i[0]]&&(a[i[0]]=i.length>2&&r.test(i[1])?[]:{});for(var o=a[i[0]],l=1;l<i.length;l++){if(""===i[l])return void 0;if("undefined"!=typeof n){if(l===i.length-1)return o[i[l]]=n,n;var u=o[i[l]];("undefined"==typeof u||null===u)&&(u=r.test(i[l+1])?[]:{},o[i[l]]=u),o=u}else o&&(o=o[i[l]])}return o}}]),angular.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function(e,r){"use strict";var t="",a={},n=function(e,r){"sfDecorator"===e&&(e=t);for(var n=a[e],i=n.rules,o=0;o<i.length;o++){var l=i[o](r);if(l)return l}return n.mappings[r.type]?n.mappings[r.type]:n.mappings["default"]},i=function(e){return/^#/.test(e)?"['"+e+"']":"."+e},o=function(e,r,t){var a="";if(angular.isDefined(e.schema)){var n=e.schema.visibility||r.visibility.visibility;n&&(a+=i(n));var o=e.schema.category||r.category;o&&(a+=i(o))}return a+=("["!==t[0]?".":"")+t,"model"+a},l=function(t){e.directive(t,["$parse","$compile","$http","$templateCache","scrollingTop","$timeout","$filter","FileUploader",function(e,a,l,u,s,f,c,d){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(s,c,m,p){var h=s.defaultGlobals||s.$eval(m.defaultGlobals),g=s.$watch(m.form,function(e){if(e){s.form=e,s.defaultGlobals=h;var i=n(t,e);l.get(i,{cache:u}).then(function(t){var n=e.key?r.stringify(e.key).replace(/"/g,"&quot;"):"";s.keyModelName=o(e,s.defaultGlobals,n);var i=t.data.replace(/\$\$value\$\$/g,s.keyModelName);c.html(i),a(c.contents())(s)}),g()}});s.globalSchema=p.evalInMainScope("schema"),s.showTitle=function(){return s.form&&s.form.notitle!==!0&&s.form.title},s.listToCheckboxValues=function(e){var r={};return angular.forEach(e,function(e){r[e]=!0}),r},s.checkboxValuesToList=function(e){var r=[];return angular.forEach(e,function(e,t){e&&r.push(t)}),r};var v=function(e){var r="",t=s.globalSchema.properties[e];if(angular.isDefined(t)){var a=t.visibility||s.defaultGlobals.visibility;a&&(r+=i(a));var n=t.category||s.defaultGlobals.category;n&&(r+=i(n))}return r+=("["!==e[0]?".":"")+e,"model"+r},y=function(e){return angular.forEach(s.form.dependencies,function(r){e=e.replace(r,v(r))}),s.$eval(e)},b=function(){var e;return angular.forEach(s.form.conditionalValues,function(r){y(r.expression)&&(e=r.value)}),e};s.showCondition=function(){var r=s.form.expression;if(angular.isUndefined(r))return!0;var t=y(r),a=e(s.keyModelName);if(angular.isDefined(s.form.required)&&(s.form.required=t,s.form.schema.required=t),angular.isArray(s.form.conditionalValues)){var n=b();angular.isDefined(n)&&a.assign(s,n)}else s.form.key&&!t&&(a.assign(s,void 0),s.ngModelHolder&&(s.ngModelHolder.$render(),s.ngModelHolder.$setPristine()));return t},s.clickCheckbox=function(r){var t=angular.element(r.currentTarget).find("input"),a=!!t.attr("checked");f(function(){t.attr("checked",!a);var r=e(s.keyModelName);r.assign(s,!a),s.$apply();var n=s.form.events||{};n.change&&n.change(!a)},0)},s.radiosChange=function(e){var r=s.form.events||{};r.change&&r.change(e)},s.disabledElement=function(){var e=s.form.disableExpression;if(angular.isUndefined(e)&&angular.isUndefined(s.form.disabled))return!1;var r=y(e);return angular.isDefined(s.form.required)&&(s.form.required=!r,s.form.schema.required=!r),r&&(s.ngModelHolder.$setViewValue(void 0),c.find("input").val("")),r||s.form.disabled};var k=function(e,r){var t=moment(),a=s.form.minMonthlyDifference||0,n=s.form.maxMonthlyDifference,i=s.form.additionalMonthlyDifference,o=s.form.additionalDailyDifference,l=moment(e);return t.milliseconds(0),t.second(0),t.minute(0),t.hours(0),n&&i&&(r||l.toDate().getTime()<moment(t).add(a,"Month").toDate().getTime()||l.toDate().getTime()>moment(t).add(n,"Month").toDate().getTime())&&(l=t.add(i,"Month").add(o,"Day")),l};s.setDateWatcher=function(){if(s.form.modelKey){var r=function(){return s.$eval(v(s.form.dateKey))};s.$watch(r,function(r){if(r){var t=e(v(s.form.modelKey)),a=k(r);t.assign(s,a.format("YYYY-MM-DD"))}})}},s.getInfoDate=function(){var r,t=s.$eval(v(s.form.dateKey));if(t)r=k(t);else if(s.form.hasDefaultDateValue){r=k(null,!0);var a=e(v(s.form.modelKey));a.assign(s,r.format("YYYY-MM-DD"))}return moment.locale(s.form.encoding),moment(r).format(s.form.format)},s.conditionalValidationSuccess=function(){var e=s.form.validationExpression;return angular.isUndefined(e)?!0:y(e)},s.evalExpr=function(e,r){return p?p.evalInParentScope(e,r):s.$eval(e,r)},s.evalInScope=function(e,r){return e?s.$eval(e,r):void 0},s.errorMessage=function(e){var r=s.form.validationMessage;return r?e?angular.isString(r)?r:r[e.code]||r["default"]:r.required||r["default"]||r:e?e.message:"Required"},s.initFileUploader=function(){var r=e(s.keyModelName),t=function(){return r(s)||r.assign(s,[]),r(s)},a=new d(s.form.uploadConfig);a.autoUpload=!0,a.removeAfterUpload=!0,a.onAfterAddingFile=function(e){s.fileUploadError=null;var a={fileName:e.file.name,uploaderFileItem:e};t().push(a),r.assign(s,t())},a.onSuccessItem=function(e,a){var n=a;if(angular.isString(a)&&/^<pre>/.test(a)){var i=a.replace(/<\/?pre>/gi,"");n=angular.fromJson(i)}t().some(function(a){return a.uploaderFileItem===e?($.extend(a,n),r.assign(s,t()),!0):!1})},a.onErrorItem=function(e){t().some(function(a){return a.uploaderFileItem===e?(r.assign(s,t()),!0):!1})},a.onWhenAddingFileFailed=function(e,r){s.fileUploadError=s.fileUploadError||{},s.fileUploadError.title=r.title},s.uploader=a,s.removeFile=function(e){var a;t().some(function(r,t){return e===r?(a=t,!0):!1}),a>=0&&(t().splice(a,1),r.assign(s,t()));var n=s.form.deleteConfig.url.match(/\{(.+)\}/)[1];if((!e.uploaderFileItem||e.uploaderFileItem.isUploaded&&!e.uploaderFileItem.isError)&&n&&e[n]){var i={url:s.form.deleteConfig.url.replace(/\{.+\}/,e[n]),method:s.form.deleteConfig.method||"DELETE",headers:s.form.deleteConfig.headers};l(i)}else e.uploaderFileItem&&e.uploaderFileItem.isUploading&&e.uploaderFileItem.cancel()},s.getExtensionFromFileName=function(e){var r=/(?:\.([^.]+))?$/;return r.exec(e)[1]},s.confirmOnFileRemove=function(e){s.form.confirmDelete?s.params.submit=angular.bind({},s.removeFile,e):s.removeFile(e)}},s.confirmOnClick=function(e){var r=(s.form.confirmDelete||{}).events||{},t=this.action,a=[];"delete"===t.type&&s.form.confirmDelete?s.params.submit=angular.bind({},r.submit,a,e):t.action(a,e)}}}}])},u=function(r,t,a){a=angular.isDefined(a)?a:!1,e.directive("sf"+angular.uppercase(r[0])+r.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:a,template:'<sf-decorator form="form"></sf-decorator>',link:function(e,t,a){var n={items:"c",titleMap:"c",schema:"c"},i={type:r},o=!0;angular.forEach(a,function(r,t){if("$"!==t[0]&&0!==t.indexOf("ng")&&"sfField"!==t){var l=function(r){angular.isDefined(r)&&r!==i[t]&&(i[t]=r,o&&i.type&&(i.key||angular.isUndefined(a.key))&&(e.form=i,o=!1))};"model"===t?e.$watch(r,function(r){r&&e.model!==r&&(e.model=r)}):"c"===n[t]?e.$watchCollection(r,l):a.$observe(t,l)}})}}})};this.createDecorator=function(e,r,n){a[e]={mappings:r||{},rules:n||[]},a[t]||(t=e),l(e)},this.createDirective=u,this.createDirectives=function(e){angular.forEach(e,function(e,r){u(r,e)})},this.directive=function(e){return e=e||t,a[e]},this.addMapping=function(e,r,t){a[e]&&(a[e].mappings[r]=t)},this.$get=function(){return{directive:function(e){return a[e]},defaultDecorator:t}},l("sfDecorator")}]),angular.module("schemaForm").factory("formFormatters",[function(){var e={carNumber:function(e){return/^[a-zA-Z]{2}\s?\d{5}$/.test(e)&&(e=e.replace(/^([a-zA-Z]{2})\s?(\d{5})$/,function(e,r,t){return r.toUpperCase()+t})),e},number:function(e){var r=parseInt(e,10);return isNaN(r)?void 0:r}};return{getFormatter:function(r){return e[r]}}}]),angular.module("schemaForm").provider("schemaForm",["sfPathProvider",function(e){var r=function(e){var r=[];return e.forEach(function(e){r.push({name:e,value:e,id:"id_"+100*Math.random()})}),r},t=function(e){if(angular.isArray(e))return angular.forEach(e,function(e,r){e.id||(e.id="id_"+100*Math.random())}),e;var r=[];return angular.forEach(e,function(e,t){r.push({name:e,value:t,id:"id_"+100*Math.random()})}),r},a=function(e,r,t){var a=m[r.type];if(a)for(var n,i=0;i<a.length;i++)if(n=a[i](e,r,t))return n},n=function(e,r,a){a=a||{};var n=a.global&&a.global.formDefaults?angular.copy(a.global.formDefaults):{};return a.global&&a.global.supressPropertyTitles===!0?n.title=r.title:n.title=r.title||e,r.description&&(n.description=r.description),(a.required===!0||r.required===!0)&&(n.required=!0),r.maxLength&&(n.maxlength=r.maxLength),r.minLength&&(n.minlength=r.minLength),(r.readOnly||r.readonly)&&(n.readonly=!0),r.minimum&&(n.minimum=r.minimum+(r.exclusiveMinimum?1:0)),r.maximum&&(n.maximum=r.maximum-(r.exclusiveMaximum?1:0)),r.validationMessage&&(n.validationMessage=r.validationMessage),r.enumNames&&(n.titleMap=t(r.enumNames)),n.schema=r,n.ngModelOptions=n.ngModelOptions||{},n},i=function(r,t,a){if("string"===t.type&&!t["enum"]){var i=n(r,t,a);return i.key=a.path,i.type="text",a.lookup[e.stringify(a.path)]=i,i}},o=function(r,t,a){if("number"===t.type){var i=n(r,t,a);return i.key=a.path,i.type="number",a.lookup[e.stringify(a.path)]=i,i}},l=function(r,t,a){if("integer"===t.type){var i=n(r,t,a);return i.key=a.path,i.type="number",a.lookup[e.stringify(a.path)]=i,i}},u=function(r,t,a){if("boolean"===t.type){var i=n(r,t,a);return i.key=a.path,i.type="checkbox",a.lookup[e.stringify(a.path)]=i,i}},s=function(t,a,i){if("string"===a.type&&a["enum"]){var o=n(t,a,i);return o.key=i.path,o.type="select",o.titleMap||(o.titleMap=r(a["enum"])),i.lookup[e.stringify(i.path)]=o,o}},f=function(t,a,i){if("array"===a.type&&a.items&&a.items["enum"]){var o=n(t,a,i);return o.key=i.path,o.type="checkboxes",o.titleMap||(o.titleMap=r(a.items["enum"])),i.lookup[e.stringify(i.path)]=o,o}},c=function(r,t,i){if("object"===t.type){var o=n(r,t,i);return o.type="fieldset",o.items=[],i.lookup[e.stringify(i.path)]=o,angular.forEach(t.properties,function(r,n){var l=i.path.slice();if(l.push(n),i.ignore[e.stringify(l)]!==!0){var u=t.required&&-1!==t.required.indexOf(n),s=a(n,r,{path:l,required:u||!1,lookup:i.lookup,ignore:i.ignore});s&&o.items.push(s)}}),o}},d=function(r,t,i){if("array"===t.type){var o=n(r,t,i);o.type="array",o.key=i.path,i.lookup[e.stringify(i.path)]=o;var l=t.required,u=i.path.slice();return u.push(""),o.items=[a(r,t.items,{path:u,required:l||!1,lookup:i.lookup,ignore:i.ignore})],o}},m={string:[s,i],object:[c],number:[o],integer:[l],"boolean":[u],array:[f,d]},p=function(e){return e};this.defaults=m,this.stdFormObj=n,this.postProcess=function(e){p=e},this.appendRule=function(e,r){m[e]||(m[e]=[]),m[e].push(r)},this.prependRule=function(e,r){m[e]||(m[e]=[]),m[e].unshift(r)},this.createStandardForm=n,this.$get=function(){var r={};return r.merge=function(a,n,i,o){n=n||["*"],o=o||{};var l=r.defaults(a,i,o),u=n.indexOf("*");if(-1!==u)return n=n.slice(0,u).concat(l.form).concat(n.slice(u+1));var s=l.lookup;return p(n.map(function(n){if("string"==typeof n&&(n={key:n}),n.titleMap&&(n.titleMap=t(n.titleMap)),n.items&&(n.items=r.merge(a,n.items,i)),n.tabs&&angular.forEach(n.tabs,function(e){e.items=r.merge(a,e.items,i)}),n.steps&&angular.forEach(n.steps,function(e){e.items=r.merge(a,e.items,i)}),n.key){"string"==typeof n.key&&(n.key=e.parse(n.key));var o=e.stringify(n.key);s[o]&&(n=angular.extend(s[o],n))}return n}))},r.defaults=function(e,r,t){var n=[],i={};if(r=r||{},t=t||{},"object"!==e.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return angular.forEach(e.properties,function(o,l){if(r[l]!==!0){var u=e.required&&-1!==e.required.indexOf(l[l.length-1]),s=a(l,o,{path:[l],lookup:i,ignore:r,required:u,global:t});s&&n.push(s)}}),{form:n,lookup:i}},r.traverseSchema=function(e,r,t,a){a=angular.isDefined(a)?a:!0,t=t||[];var n=function(e,r,t){if(r(e,t),angular.forEach(e.properties,function(e,a){var i=t.slice();i.push(a),n(e,r,i)}),!a&&e.items){var i=t.slice();i.push(""),n(e.items,r,i)}};n(e,r,t||[])},r.traverseForm=function(e,t){t(e),angular.forEach(e.items,function(e){r.traverseForm(e,t)}),e.tabs&&angular.forEach(e.tabs,function(e){angular.forEach(e.items,function(e){r.traverseForm(e,t)})}),e.steps&&angular.forEach(e.steps,function(e){angular.forEach(e.items,function(e){r.traverseForm(e,t)})})},r}}]),angular.module("schemaForm").factory("scrollingTop",["$timeout",function(e){var r=function(r,t){e(function(){jQuery("html, body").animate({scrollTop:jQuery(r[0]).find("[index="+t+"] .has-error:first").offset().top},1e3)},0)},t=function(){e(function(){jQuery("html, body").animate({scrollTop:0},1e3)},0)};return{scrollToTheFirstError:r,scrollTop:t}}]),angular.module("schemaForm").factory("sfValidator",[function(){var e={};return tv4.addFormat({ssn:function(e,r){var t,a=[3,7,6,1,8,9,4,5,2,1,0],n=[5,4,3,2,7,6,5,4,3,2,1],i=0,o=0,l=0;if("string"!=typeof e)return"ssn should be a string!";for(t=e.split("");l<a.length;l+=1)i+=t[l]*a[l],o+=t[l]*n[l];return i%11==0&&o%11==0?null:"incorrect ssn"},email:function(e,r){return"string"==typeof e?/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/i.test(e)?null:"invalid email":"email should be a string!"},"date-format":function(e,r){return"string"==typeof e?Date.parse(e)?null:"invalid date":"date should be ISO string!"}}),e.validate=function(e,r){var t=e.schema;if(!t)return r;"integer"===t.type?r=parseInt(r,10):"number"===t.type?r=parseFloat(r,10):"boolean"===t.type&&"string"==typeof r&&("true"===r?r=!0:"false"===r&&(r=!1));var a={type:"object",properties:{}},n=e.key[e.key.length-1];a.properties[n]=t,t.required&&(a.required=[n]);var i={};return angular.isDefined(r)&&(i[n]=r),tv4.validateResult(i,a)},e}]),angular.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator",function(e,r,t){var a=function(e){return function(r){r.key&&(r.key[r.key.indexOf("")]=e)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(n,i,o,l){var u={},s=n.$watch(o.sfArray,function(i){var o=e(i.key,n.model);if(angular.isUndefined(o)&&(o=[],e(i.key,n.model,o)),n.modelArray=o,i.items){var f=i.items[0];i.items.length>1&&(f={type:"section",items:i.items})}if(n.copyWithIndex=function(e){if(!u[e]&&f){var t=angular.copy(f);t.arrayIndex=e,r.traverseForm(t,a(e)),u[e]=t}return u[e]},n.appendToArray=function(){var t=o.length,a=n.copyWithIndex(t);if(r.traverseForm(a,function(r){r.key&&angular.isDefined(r["default"])&&e(r.key,n.model,r["default"])}),t===o.length){var l,u=e("schema.items.type",i);"object"===u?l={}:"array"===u&&(l=[]),o.push(l)}return n.validateArray&&n.validateArray(),o},n.deleteFromArray=function(e){o.splice(e,1),n.validateArray&&n.validateArray()},i.titleMap||i.startEmpty===!0||0!==o.length||n.appendToArray(),i.titleMap&&i.titleMap.length>0){n.titleMapValues=[];var c=function(e){n.titleMapValues=[],e=e||[],i.titleMap.forEach(function(r){n.titleMapValues.push(-1!==e.indexOf(r.value))})};c(n.modelArray),n.$watchCollection("modelArray",c),n.$watchCollection("titleMapValues",function(e){if(e){for(var r=n.modelArray;r.length>0;)r.shift();i.titleMap.forEach(function(t,a){e[a]&&r.push(t.value)})}})}if(l){var d;n.validateArray=function(){var e=t.validate(i,n.modelArray.length>0?n.modelArray:void 0);e.valid!==!1||!e.error||""!==e.error.dataPath&&e.error.dataPath!=="/"+i.key[i.key.length-1]?l.$setValidity("schema",!0):(l.$setViewValue(n.modelArray),d=e.error,l.$setValidity("schema",!1))},n.$on("schemaFormValidate",n.validateArray),n.hasSuccess=function(){return l.$valid&&!l.$pristine},n.hasError=function(){return l.$invalid},n.schemaError=function(){return d}}s()})}}}]),angular.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(e,r,t,a){var n=e.$eval(t.sfChanged);n&&n.onChange&&a.$viewChangeListeners.push(function(){angular.isFunction(n.onChange)?n.onChange(a.$modelValue,n):e.evalExpr(n.onChange,{modelValue:a.$modelValue,form:n})})}}}),angular.module("schemaForm").directive("infoHelpMessage",[function(){return{restrict:"AE",templateUrl:"directives/decorators/stb-webmanual/info-message.html",scope:{infoMessage:"="},link:function(e,r,t){}}}]),angular.module("schemaForm").directive("ngModelOnblur",["formFormatters","$parse",function(e,r){return{restrict:"A",require:"ngModel",priority:1,link:function(r,t,a,n){if("radio"!==a.type&&"checkbox"!==a.type){var i=e.getFormatter(r.$eval(a.formatterName))||function(e){return e};t.unbind("input").unbind("keydown").unbind("change"),t.bind("blur",function(){r.$apply(function(){(/[^\s]/.test(t.val())||!n.$pristine||n.$modelValue)&&(n.$setViewValue(i(t.val())),n.$render())})});var o=r.$eval(a.modelMaxLength);angular.isDefined(o)&&t.bind("keydown",function(e){var r=e.which,a=32>r||r>34&&41>r||46===r;return a?!0:void(t.val().length>=o&&e.preventDefault())})}}}}]),angular.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect",function(e,r,t,a){var n=/[A-Z]/g,i=function(e,r){return r=r||"_",e.replace(n,function(e,t){return(t?r:"")+e.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel"},controller:["$scope",function(e){this.evalInParentScope=function(r,t){return e.$parent.$eval(r,t)},this.evalInMainScope=function(r,t){return e.$eval(r,t)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(n,o,l,u,s){n.formCtrl=u,n.defaultGlobals=n.$eval(l.defaultGlobals)||{visibility:"",category:""};var f={};s(n,function(e){if(e.addClass("schema-form-ignore"),o.prepend(e),o[0].querySelectorAll){var r=o[0].querySelectorAll("[ng-model]");if(r)for(var t=0;t<r.length;t++){var a=r[t].getAttribute("ng-model");f[a.substring(a.indexOf(".")+1)]=!0}}});var c={};n.$watch(function(){var u=n.schema,s=n.initialForm||["*"];if(s&&u&&u.type&&(c.form!==s||c.schema!==u)&&Object.keys(u.properties).length>0){c.schema=u,c.form=s;var d=n.$eval(l.sfOptions),m=r.merge(u,s,f,d),p=document.createDocumentFragment();n.schemaForm={form:m,schema:u},angular.forEach(m,function(e,r){var a=document.createElement(l.sfDecoratorName||i(t.defaultDecorator,"-"));a.setAttribute("form","schemaForm.form["+r+"]"),a.setAttribute("default-globals","defaultGlobals"),p.appendChild(a)}),o.children(":not(.schema-form-ignore)").remove(),o[0].appendChild(p),e(o.children())(n),r.traverseSchema(u,function(e,r){if(angular.isDefined(e["default"])){var t=a(r,n.model);angular.isUndefined(t)&&a(r,n.model,e["default"])}})}})}}}]),angular.module("schemaForm").directive("schemaValidate",["sfValidator",function(e){return{restrict:"A",scope:!1,priority:1e3,require:"ngModel",link:function(r,t,a,n){var i=null;"radio"===a.type?(r=r.$parent,r.ngModel||(r.ngModel=n)):r.ngModel=n;var o=function(){return l||(l=r.$eval(a.schemaValidate)),l},l=o();l.copyValueTo&&n.$viewChangeListeners.push(function(){var e=l.copyValueTo;angular.forEach(e,function(e){sfSelect(e,r.model,n.$modelValue)})}),n.$validators?n.$validators.schema=function(r){var t=e.validate(o(),r);return i=t.error,t.valid}:n.$parsers.push(function(r){if(l=o(),!l)return r;var t=e.validate(l,r);return t.valid?(n.$setValidity("schema",!0),r):(n.$setValidity("schema",!1),void(i=t.error))});var u=function(e,r){var t=!0;return r&&r.indexOf(e)<0&&(t=!1),t};r.$on("schemaFormValidate",function(e,r){var t=r&&r.modelKeys,a=r&&r.modelKeysValidationResult;if(t&&!t.indexOf)throw'"modelKeys" property of arguments passed should be an array';if(u(l.key[0],t)){if(t&&!a)throw'"modelKeysValidationResult" property of arguments passed should be defined';n.$validate?(n.$validate(),a[l.key[0]]={isValid:n.$valid},n.$invalid&&(n.$dirty=!0,n.$pristine=!1)):n.$setViewValue(n.$viewValue)}}),r.$on("schemaFormValidationClean",function(e,r){var a=r&&r.modelKeys;if(a&&!a.indexOf)throw'"modelKeys" property of arguments passed should be an array';u(l.key[0],a)&&(t[0].value="",n.$setViewValue(void 0),n.$setPristine())}),r.hasSuccess=function(){return n.$valid&&(!n.$pristine||!n.$isEmpty(n.$modelValue))},r.hasError=function(){return n.$invalid&&!n.$pristine},r.schemaError=function(){return i}}}}]);