<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Stb Webmanual Form Editor</title>
    <link rel="stylesheet" href="../bower_components/pickadate/lib/themes/classic.css">
    <link rel="stylesheet" href="../bower_components/pickadate/lib/themes/classic.date.css">
    <link rel="stylesheet" href="../bower_components/pickadate/lib/themes/classic.time.css">
    <link rel="stylesheet" href="../bower_components/bootstrap-vertical-tabs/bootstrap.vertical-tabs.min.css">
    <link rel="stylesheet" href="../bower_components/stb-datetimepicker/dist/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="../dist/schema-form.min.css">
    <link href="//elements.storebrand.no/storebrand.ny/0.47/css/stb-main.css" type="text/css" rel="stylesheet"/>
</head>
<body style="background: #efe8df;" ng-app="test" ng-controller="TestCtrl">
<style>
    .step-content {
        background: #efe8df;
    }
</style>

<div class="container">
    <form name="ngform"  sf-model="modelData" sf-form="form" sf-schema="schema" sf-decorator-name="stb-webmanual-decorator" ng-submit="submitForm(ngform,modelData)">
        <button type="submit"></button>
    </form>
</div>
<script type="text/javascript" src="../bower_components/jquery/dist/jquery.min.js"></script>
<script type="text/javascript" src="../bower_components/jquery-ui/jquery-ui.js"></script>
<script type="text/javascript" src="../bower_components/moment/min/moment-with-locales.min.js"></script>
<script type="text/javascript" src="../bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="../bower_components/tv4/tv4.js"></script>
<script type="text/javascript" src="../bower_components/angular/angular.min.js"></script>
<script type="text/javascript" src="../bower_components/angular-sanitize/angular-sanitize.min.js"></script>

<script type="text/javascript" src="../bower_components/angular-ui-sortable/sortable.js"></script>
<script type="text/javascript" src="../bower_components/objectpath/lib/ObjectPath.js"></script>

<script type="text/javascript" src="../dist/schema-form.js"></script>
<script type="text/javascript" src="../dist/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="../dist/dropdown.min.js"></script>
<script type="text/javascript" src="../dist/stb-webmanual-decorator.min.js"></script>
<script type="text/javascript">
    angular.module('test',['schemaForm']).controller('TestCtrl', function TestCtrl ($scope, $http){
        var res = {};
        res.data = {
            "schema": {
                "type": "object",
                "properties": {
                    "mainCause": {
                        "type": "string",
                        "required": true,
                        "enum": ["broken"]
                    },
                    "dateQuestion": {
                        "type": "string",
                        "format": "date",
                        "required": true
                    },
                    "thirdQuestion": {
                        "type": "string",
                        "required": true,
                        "minLength": 2,
                        "maxLength": 5
                    },
                    "fourthQuestion": {
                        "type": "string",
                        "required": true,
                        "minLength": 2,
                        "maxLength": 5
                    },
                    "question21": {
                        "type": "string",
                        "required": true,
                        "minLength": 2,
                        "maxLength": 5
                    },
                    "question22": {
                        "type": "string",
                        "required": true,
                        "minLength": 2,
                        "maxLength": 5
                    },
                    "question23": {
                        "type": "string",
                        "required": true,
                        "minLength": 1,
                        "maxLength": 5
                    },
                    "question24": {
                        "type": "boolean",
                        "required": true
                    },
                    "question31": {
                        "type": "string",
                        "required": true,
                        "minLength": 1
                    },
                    "question32": {
                        "type": "string",
                        "required": true,
                        "minLength": 1
                    },
                    "question41": {
                        "type": "string",
                        "required": true,
                        "minLength": 1
                    },
                    "question42": {
                        "type": "string",
                        "required": true,
                        "minLength": 1
                    },
                    "question43": {
                        "type": "string",
                        "required": true,
                        "minLength": 1
                    },
                    "question44": {
                        "type": "boolean",
                        "required": true
                    },
                    "question45": {
                        "type": "boolean",
                        "required": true
                    }
                }
            },
            "form": [
                {
                    "type": "steps",
                    "nextButtonText": "Neste",
                    "prevButtonText": "Tillbake",
                    "lastButtonText": "Finish",
                    "steps": [
                        {
                            "title": "Om skaden",
                            "items": [
                                {
                                    "type": "help",
                                    "helpvalue": "<h2>Om tapet/skaden</h2>"
                                },
                                {
                                    "type": "fieldset",
                                    "title": "Hva har skjedd?",
                                    "items": [
                                        {
                                            "key": "mainCause",
                                            "title": "Hva har skjedd med gjenstanden(e)?",
                                            "type": "radios-inline",
                                            "required": true,
                                            "titleMap": {
                                                "stolen": "Stj√•let",
                                                "broken": "Skadet"
                                            }
                                        },
                                        {
                                            "key": "dateQuestion",
                                            "title": "Nar ble gjenstanden(e) skadet?",
                                            "required": true,
                                            "minDate": "1900-01-01",
                                            "maxDate": "2014-04-04"
                                        },
                                        {
                                            "key": "thirdQuestion",
                                            "title": "I hvilket land skjadde skaden?"
                                        },
                                        {
                                            "key": "fourthQuestion",
                                            "title": "Pa hvilket sted skjedde skaden?"
                                        }
                                    ]
                                },
                                {
                                    "type": "fieldset",
                                    "title": "Hvordan skjedde det?",
                                    "items": [
                                        {
                                            "key": "question21",
                                            "title": "Pa hvilken mote tror du skaden kan ha skjedd?",
                                            "type": "textarea"
                                        },
                                        {
                                            "key": "question22",
                                            "title": "Hvor oppholdt du deg nar skaden skjedde? Og hvilke aktiviteter ble utfort?",
                                            "type": "textarea"
                                        },
                                        {
                                            "type": "condition",
                                            "conditionalKey": "question24",
                                            "conditionalValue": "true",
                                            "items": [
                                                {
                                                    "key": "question23",
                                                    "title": "La du merke til en speciell hendelse som kan ha med skaden a gjore?",
                                                    "type": "textarea"
                                                }
                                            ]
                                        },
                                        {
                                            "key": "question24",
                                            "title": "Var det utenforstaende vitne(r) til hendelsen?",
                                            "type": "radios-inline",
                                            "titleMap": [
                                                {'name': 'Ja', 'value': true},
                                                {'name': 'Nei', 'value': false}
                                            ]
                                        },
                                        {
                                            "key": "uploader",
                                            "type": "file",
                                            "title": "Last opp",
                                            "addFile": function (filePath) {
                                                var file = {
                                                    name:      filePath.split('\\').pop(),
                                                    extension: filePath.split('.').pop()
                                                };
                                                $scope.modelData.uploader = $scope.modelData.uploader || [];

                                                $scope.$apply(function(){
                                                    $scope.modelData.uploader.push(file);
                                                });
                                            },
                                            "removeFile": function (index) {
                                                $scope.modelData.uploader.splice(index, 1);
                                            }
                                        },
                                        {
                                            'key': 'previousDamagesCommands',
                                            'type': 'command-panel',
                                            'dependencies': ['question24'],
                                            'expression': 'question24 === true',
                                            'commands': [
                                                {
                                                    'title': 'add',
                                                    'action': function () {alert('add');},
                                                    'isVisible': function () {return true;}
                                                },
                                                {
                                                    'title': 'update',
                                                    'action': function () {alert('update');},
                                                    'isVisible': function () {return false;}
                                                },
                                                {
                                                    'title': 'delete',
                                                    'action': function () {alert('delete');},
                                                    'isVisible': function () {return true;}
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "whitebox",
                                    "items": [
                                        {
                                            "type": "fieldset",
                                            "title": "Annet",
                                            "items": [
                                                {
                                                    "key": "question3dd1",
                                                    "helpvalue": "<h4>" + "Oppbevart?" + "</h4>",
                                                    "type": "help",
                                                    'infoMessage': 'Media queries can be nested in the same way as selectors. Selectors are copied into the body of the media query:'
                                                },
                                                {
                                                    "key": "question31",
                                                    "helpvalue": "Hvor og hvordan var gjenstanden(e) oppbevart?",
                                                    "type": "help",
                                                    'infoMessage': 'Media queries can be nested in the same way as selectors. Selectors are copied into the body of the media query:'
                                                },
                                                {
                                                    "key": "question32",
                                                    "title": "Andre opplysninger om skaden?",
                                                    "type": "textarea"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "title": "Skadet gjenstand",
                            "items": [
                                {
                                    "type": "help",
                                    "helpvalue": "<h2>Skadet gjenstand</h2>"
                                },
                                {
                                    "type": "fieldset",
                                    "title": "Legg til gjenstanden(e)",
                                    "items": [
                                        {
                                            "key": "question41",
                                            "title": "Type gjenstand",
                                            "subtitle": "(Merke og modell)",
                                            "type": "text"
                                        },
                                        {
                                            "key": "question42",
                                            "title": "Hvor gammel er gjenstanden",
                                            "type": "select",
                                            "titleMap": {
                                                "15": "15 ar",
                                                "20": "20 ar",
                                                "25": "25 ar",
                                                "30": "30 ar",
                                                "35": "35 ar",
                                                "40": "40 ar",
                                                "45": "45 ar"
                                            }
                                        },
                                        {
                                            "key": "question43",
                                            "title": "Hvor ble gjenstanden kjopt?",
                                            "subtitle": "(Butikk eller annet)",
                                            "type": "textarea"
                                        },
                                        {
                                            "key": "question44",
                                            "title": "Var gjenstanden ny ved anskaffelse?",
                                            "type": "radios-inline",
                                            "titleMap": {
                                                "true": "Ja",
                                                "false": "Nei"
                                            }
                                        },
                                        {
                                            "key": "question45",
                                            "title": "Kan gjenstanden repareres?",
                                            "type": "radios-inline",
                                            "titleMap": {
                                                "true": "Ja",
                                                "false": "Nei"
                                            }
                                        },
                                        {
                                            "key": "fileupload",
                                            "type": "file",
                                            "action": function (fileSource) {
                                                console.log(fileSource);
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "title": "Om reisen",
                            "items": [
                            ]
                        },
                        {
                            "title": "Perosonopplysninger",
                            "items": [
                            ]
                        },
                        {
                            "title": "Oppsummering",
                            "items": [
                            ]
                        },
                        {
                            "title": "Kvittering",
                            "items": [
                            ]
                        }
                    ]
                }
            ]
        };
        $scope.schema = res.data.schema;
        $scope.form   = res.data.form;
        $scope.form[0].finishIt = 'click()';
        $scope.click = function () {
            console.log('fasf')
        };
        $scope.modelData = { currentStep: 1 };
        window.md = $scope.modelData;
        //});
        $scope.submitForm = function (form, model) {
            console.log(model);
            $scope.$broadcast('schemaFormValidate');
            if (form.$valid) {
                console.log('You did it!');
            }
        };
//        $scope.getFileName = function (name) {
//          console.log(name);
//        };
    });
</script>
</body>
</html>